# ğŸ¯ Diagrama Visual: Cadastro e Registro do ESP32

## ğŸ—ï¸ Arquitetura Completa do Sistema

```
                          SEU COMPUTADOR (Localhost)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      FRONTEND (React)                             â”‚  â”‚
â”‚  â”‚                    http://localhost:3000                          â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  Ambientes  â”‚   Sensores   â”‚ Monitoramentoâ”‚  HistÃ³rico   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚             â”‚              â”‚              â”‚              â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [+ Novo]    â”‚ [+ Novo]     â”‚ [ğŸŒ¡ï¸28.5Â°C]  â”‚ [ğŸ“Š GrÃ¡fico] â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ Listar      â”‚ Editar       â”‚ [ğŸ’§65.2%]   â”‚ EstatÃ­sticas â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ Deletar     â”‚ Deletar      â”‚ [â±ï¸Agora]   â”‚              â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  HTTP Requests (GET, POST, PUT, DELETE)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                         â”‚
â”‚                              â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 BACKEND (Node.js/Express)                         â”‚  â”‚
â”‚  â”‚                  http://localhost:3000                           â”‚  â”‚
â”‚  â”‚                                                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ API Routes   â”‚ Controllers â”‚ Middleware   â”‚ MQTT Client  â”‚   â”‚  â”‚
â”‚  â”‚  â”‚              â”‚             â”‚              â”‚              â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ /api/ambien. â”‚ ambiente    â”‚ autenticaÃ§Ã£o â”‚ Escuta tÃ³picoâ”‚   â”‚  â”‚
â”‚  â”‚  â”‚ /api/sensoresâ”‚ sensor      â”‚ validaÃ§Ã£o    â”‚ ProjetoFinalIot   â”‚  â”‚
â”‚  â”‚  â”‚ /api/leiturasâ”‚ leitura     â”‚ rate-limit   â”‚              â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                      â”‚             â”‚  â”‚
â”‚  â”‚  processarLeitura(data) â† â† â† MQTT Message â† â† â† â”€â”¤             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Criar/Atualizar Sensor                          â”‚             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Salvar Temperatura                              â”‚             â”‚  â”‚
â”‚  â”‚  â”œâ”€ Salvar Umidade                                  â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€ Salvar PotenciÃ´metro                            â”‚             â”‚  â”‚
â”‚  â”‚                                                      â”‚             â”‚  â”‚
â”‚  â”‚  Database Queries (INSERT, SELECT, UPDATE)           â†“             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                      â”‚               â”‚
â”‚                                 â†“                      â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚               â”‚
â”‚  â”‚         SQLite Database (db.sqlite)           â”‚      â”‚               â”‚
â”‚  â”‚                                               â”‚      â”‚               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â”‚               â”‚
â”‚  â”‚  â”‚    Ambientes    â”‚     Sensores        â”‚   â”‚      â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ id=1            â”‚ id=5                â”‚   â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ nome=Sala1      â”‚ nome=ESP32-Sala1    â”‚   â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ local=Andar2    â”‚ tipo=temp_umidade   â”‚   â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ temp_ideal=25   â”‚ id_ambiente=1  â†â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚  â”‚ umidade_ideal=60â”‚ status=ativo        â”‚   â”‚      â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚      â”‚               â”‚
â”‚  â”‚                                  â”‚             â”‚      â”‚               â”‚
â”‚  â”‚                                  â†“             â”‚      â”‚               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚               â”‚
â”‚  â”‚  â”‚            Leituras                       â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ id=1: id_sensor=5, tipo=temperatura     â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚        valor=28.5, timestamp=2025-12...â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ id=2: id_sensor=5, tipo=umidade        â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚        valor=65.2, timestamp=2025-12...â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚ id=3: id_sensor=5, tipo=potenciometro  â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â”‚        valor=2048, timestamp=2025-12...â”‚ â”‚      â”‚               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚               â”‚
â”‚                                                         â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                      INTERNET (Broker PÃºblico)
                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                            â”‚
                      â†“                            â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   MQTT Broker            â”‚  â”‚   ESP32 (Iot/)           â”‚
        â”‚   broker.hivemq.com      â”‚  â”‚                          â”‚
        â”‚   :1883                  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
        â”‚                          â”‚  â”‚  â”‚   CÃ³digo (main.cpp)  â”‚â”‚
        â”‚  TÃ³pico:                 â”‚  â”‚  â”‚                      â”‚â”‚
        â”‚  ProjetoFinalIot         â”‚  â”‚  â”‚ 1. Conecta WiFi      â”‚â”‚
        â”‚                          â”‚  â”‚  â”‚ 2. LÃª ADC (pino 32)  â”‚â”‚
        â”‚  â”œâ”€ Temp                 â”‚  â”‚  â”‚ 3. Converte valores  â”‚â”‚
        â”‚  â”œâ”€ Umidade              â”‚  â”‚  â”‚ 4. Publica JSON      â”‚â”‚
        â”‚  â””â”€ Potenciometro        â”‚  â”‚  â”‚    a cada 5 segundos â”‚â”‚
        â”‚                          â”‚  â”‚  â”‚                      â”‚â”‚
        â”‚  Subscribe:              â”‚  â”‚  â”‚ {"Temp": 28.5,       â”‚â”‚
        â”‚  Backend (Node.js)       â”‚  â”‚  â”‚  "Umidade": 65.2,    â”‚â”‚
        â”‚                          â”‚  â”‚  â”‚  "Potenciometro":2048â”‚â”‚
        â”‚  Publish:                â”‚  â”‚  â”‚ }                    â”‚â”‚
        â”‚  ESP32                   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
        â”‚                          â”‚  â”‚                          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                                       â”‚  â”‚ Hardware             â”‚â”‚
                                       â”‚  â”‚ â”œâ”€ ESP32-DEV        â”‚â”‚
                                       â”‚  â”‚ â”œâ”€ WiFi             â”‚â”‚
                                       â”‚  â”‚ â”œâ”€ ADC: pino 32     â”‚â”‚
                                       â”‚  â”‚ â””â”€ PotenciÃ´metro    â”‚â”‚
                                       â”‚  â”‚    (0-4095)         â”‚â”‚
                                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Fluxo Passo a Passo com Detalhes

### **PASSO 1: Preparar ESP32** (one-time)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ARQUIVO: Iot/include/credentials.h                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  #define WIFI_SSID "seu_wifi"                              â”‚
â”‚  #define WIFI_PASS "sua_senha"                             â”‚
â”‚                                                             â”‚
â”‚  âœï¸ Editar com seus dados reais                            â”‚
â”‚  ğŸ“¤ Upload via PlatformIO                                  â”‚
â”‚  âœ… Serial Monitor: conectado ao WiFi + MQTT               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 2: Iniciar Backend** (contÃ­nuo)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TERMINAL 1: Backend                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  $ cd backend                                               â”‚
â”‚  $ npm run dev                                              â”‚
â”‚                                                             â”‚
â”‚  âœ… Output esperado:                                        â”‚
â”‚     âœ“ Conectado ao broker MQTT                             â”‚
â”‚     âœ“ Inscrito no tÃ³pico: ProjetoFinalIot                 â”‚
â”‚     ğŸš€ Servidor rodando em http://localhost:3000           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 3: Iniciar Frontend** (contÃ­nuo)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TERMINAL 2: Frontend                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  $ cd front-ambiental                                       â”‚
â”‚  $ npm start                                                â”‚
â”‚                                                             â”‚
â”‚  âœ… Output esperado:                                        â”‚
â”‚     Compiled successfully!                                  â”‚
â”‚     Abre: http://localhost:3000 no navegador               â”‚
â”‚                                                             â”‚
â”‚  ğŸ” Fazer LOGIN (credenciais necessÃ¡rias)                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 4: Criar Ambiente no Frontend**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND: Menu â†’ Ambientes â†’ "+ Novo Ambiente"            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FormulÃ¡rio de Novo Ambiente                         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Nome: Sala de Servidores                           â”‚  â”‚
â”‚  â”‚  DescriÃ§Ã£o: Monitoramento ambiental                 â”‚  â”‚
â”‚  â”‚  LocalizaÃ§Ã£o: Andar 2, Sala 201                     â”‚  â”‚
â”‚  â”‚  Temperatura Ideal: 25 Â°C                           â”‚  â”‚
â”‚  â”‚  Umidade Ideal: 60 %                                â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚                        [Salvar]                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  âœ… Resposta do Backend:                                   â”‚
â”‚     {                                                      â”‚
â”‚       "id": 1,                                             â”‚
â”‚       "nome": "Sala de Servidores",                        â”‚
â”‚       "descricao": "...",                                  â”‚
â”‚       "localizacao": "Andar 2, Sala 201",                 â”‚
â”‚       "temperatura_ideal": 25,                            â”‚
â”‚       "umidade_ideal": 60                                 â”‚
â”‚     }                                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 5: Cadastrar Sensor ESP32 no Frontend**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND: Menu â†’ Sensores â†’ "+ Novo Sensor"               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FormulÃ¡rio de Novo Sensor                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Nome: ESP32-Sala1                                  â”‚  â”‚
â”‚  â”‚  Tipo: temperatura_umidade                          â”‚  â”‚
â”‚  â”‚  Modelo: ESP32-DEV                                  â”‚  â”‚
â”‚  â”‚  DescriÃ§Ã£o: Sensor IoT para monitoramento           â”‚  â”‚
â”‚  â”‚  Ambiente: [Sala de Servidores] â–¼                   â”‚  â”‚
â”‚  â”‚  Status: ativo                                      â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚                        [Salvar]                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  HTTP POST /api/sensores                                   â”‚
â”‚  {                                                         â”‚
â”‚    "nome": "ESP32-Sala1",                                  â”‚
â”‚    "tipo": "temperatura_umidade",                          â”‚
â”‚    "modelo": "ESP32-DEV",                                  â”‚
â”‚    "descricao": "...",                                     â”‚
â”‚    "id_ambiente": 1,                                       â”‚
â”‚    "status": "ativo"                                       â”‚
â”‚  }                                                         â”‚
â”‚                                                             â”‚
â”‚  âœ… Resposta do Backend:                                   â”‚
â”‚     {                                                      â”‚
â”‚       "id": 5,                                             â”‚
â”‚       "nome": "ESP32-Sala1",                               â”‚
â”‚       "tipo": "temperatura_umidade",                       â”‚
â”‚       "id_ambiente": 1,                                    â”‚
â”‚       "status": "ativo"                                    â”‚
â”‚     }                                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 6: Dados ComeÃ§am a Chegar Automaticamente**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MQTT â†’ Backend â†’ Banco de Dados (AUTOMÃTICO A CADA 5 SEGUNDOS)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â±ï¸ Tempo: T+0s                                               â”‚
â”‚  ESP32: LÃª ADC = 3200 (valor bruto)                           â”‚
â”‚  ESP32: Converte                                              â”‚
â”‚         Temp = map(3200, 0, 4095, 15, 35) = 28.5Â°C          â”‚
â”‚         Umidade = map(3200, 0, 4095, 0, 100) = 78%           â”‚
â”‚  ESP32: Publica MQTT                                          â”‚
â”‚  {                                                            â”‚
â”‚    "Temp": 28.5,                                              â”‚
â”‚    "Umidade": 78.2,                                           â”‚
â”‚    "Potenciometro": 3200                                      â”‚
â”‚  }                                                            â”‚
â”‚                                                                â”‚
â”‚  â±ï¸ Tempo: T+0.1s                                             â”‚
â”‚  Backend: Recebe mensagem                                    â”‚
â”‚  Backend: Chama processarLeitura(data)                       â”‚
â”‚  Backend: Procura sensor "ESP32_Principal"                   â”‚
â”‚  Backend: Insere 3 linhas na tabela Leituras:               â”‚
â”‚                                                                â”‚
â”‚    INSERT INTO Leituras (id_sensor, valor, tipo_leitura)    â”‚
â”‚    VALUES (5, 28.5, 'temperatura'),                          â”‚
â”‚           (5, 78.2, 'umidade'),                              â”‚
â”‚           (5, 3200, 'potenciometro');                        â”‚
â”‚                                                                â”‚
â”‚  â±ï¸ Tempo: T+1-5s                                            â”‚
â”‚  Frontend: Faz polling /api/leituras?id_sensor=5            â”‚
â”‚  Frontend: Recebe dados JSON                                 â”‚
â”‚  Frontend: Renderiza Dashboard                               â”‚
â”‚                                                                â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—                      â”‚
â”‚  â•‘ ESP32-Sala1          [ğŸŸ¢ Ativo]    â•‘                      â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£                      â”‚
â”‚  â•‘ ğŸŒ¡ï¸ Temperatura:  28.5Â°C            â•‘                      â”‚
â”‚  â•‘ ğŸ’§ Umidade:      78.2%             â•‘                      â”‚
â”‚  â•‘ â° Atualizado:    5 segundos atrÃ¡s  â•‘                      â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **PASSO 7: Ciclo ContÃ­nuo (a cada 5 segundos)**

```
         T+0s        T+5s         T+10s        T+15s
          â”‚           â”‚            â”‚            â”‚
ESP32:    â”‚ESP32:     â”‚ESP32:      â”‚ESP32:      â”‚
          â”‚LÃª ADC     â”‚LÃª ADC      â”‚LÃª ADC      â”‚LÃª ADC
          â”‚Publica    â”‚Publica     â”‚Publica     â”‚Publica
          â†“           â†“            â†“            â†“
Backend:  â”‚Backend:   â”‚Backend:    â”‚Backend:    â”‚
          â”‚Recebe     â”‚Recebe      â”‚Recebe      â”‚Recebe
          â”‚Salva 3x   â”‚Salva 3x    â”‚Salva 3x    â”‚Salva 3x
          â†“           â†“            â†“            â†“
Banco:    â”‚Banco:     â”‚Banco:      â”‚Banco:      â”‚
          â”‚+3 linhas  â”‚+3 linhas   â”‚+3 linhas   â”‚+3 linhas
          â†“           â†“            â†“            â†“
Frontend: â”‚Frontend:  â”‚Frontend:   â”‚Frontend:   â”‚
          â”‚Atualiza   â”‚Atualiza    â”‚Atualiza    â”‚Atualiza
          â”‚Dashboard  â”‚Dashboard   â”‚Dashboard   â”‚Dashboard
```

---

## ğŸ¯ DecisÃ£o de Fluxo

```
â”Œâ”€ VocÃª quer visualizar dados?
â”‚  â””â”€ Menu â†’ Monitoramento
â”‚     â””â”€ Dashboard com grÃ¡ficos em tempo real
â”‚
â”œâ”€ VocÃª quer histÃ³rico?
â”‚  â””â”€ Menu â†’ HistÃ³rico
â”‚     â””â”€ GrÃ¡ficos 24h, 7d, 30d
â”‚
â”œâ”€ VocÃª quer gerenciar sensores?
â”‚  â””â”€ Menu â†’ Sensores
â”‚     â””â”€ Criar, Editar, Deletar
â”‚
â”œâ”€ VocÃª quer gerenciar salas?
â”‚  â””â”€ Menu â†’ Ambientes
â”‚     â””â”€ Criar, Editar, Deletar
â”‚
â””â”€ VocÃª quer exibir nÃºmeros brutos?
   â””â”€ Menu â†’ Leituras
      â””â”€ Tabela com todos os registros
```

---

**Diagrama completo do sistema IoT**  
**Criado em:** 09/12/2025  
**VersÃ£o:** 1.0
